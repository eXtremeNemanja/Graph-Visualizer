<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Graph visualization</title>
    {% load static %}
    <script type="text/javascript" src="https://d3js.org/d3.v3.js"></script>
    <link rel="stylesheet" href="{% static 'style.css' %}" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200&display=swap" rel="stylesheet">

</head>

<body>
    <div id="navbar">
        <div class="topnav">
            <span id="title">Graph Visualizer</span>
                <a class="left-plugins" href="javascript:{}" onclick="document.getElementById('loader').value = 'XmlLoader'; document.getElementById('loader_form').submit();">XML Parser</a>
                <a class="left-plugins" href="javascript:{}" onclick="document.getElementById('loader').value = 'JsonLoader'; document.getElementById('loader_form').submit();">JSON Parser</a>
                <a class="left-plugins" href="javascript:{}" onclick="document.getElementById('loader').value = 'RDFLoader'; document.getElementById('loader_form').submit();">RDF Parser</a>

                <a class="right-plugins" href="{% url 'simple_visualizer' %}">Simple View</a>
                <a class="right-plugins" href="{% url 'complex_visualizer' %}">Complex View</a>
            </div>

            <div class="choose-file">
                <form id="loader_form" enctype="multipart/form-data" method="post" action="{% url 'load' %}">
                    <input required type="file" name="file" id="file"/>
                    {% if file_missing %}
                        <small class="error">Upload file is required</small>
                    {% endif %}
                    <input type="hidden" id="loader" name="loader" />
                    {% if stepper == 1 %}
                        <p class="stepper">1. Please choose a file and then a parser</p>
                    {% else %}
                        <p class="stepper">2. Please choose a view</p>
                    {% endif %}
                </form>
            </div>
        </div>


    </div>

    {% block index %}{% endblock %}

</body>

<script>
    function scrollIfNeeded(element, container) {
        if (element == null)
            return
        if (element.offsetTop < container.scrollTop) {
            container.scrollTop = element.offsetTop;
        }
        else {
            const offsetBottom = element.offsetTop + element.offsetHeight;
            const scrollBottom = container.scrollTop + container.offsetHeight;
            if (offsetBottom > scrollBottom) {
                container.scrollTop = offsetBottom - container.offsetHeight;
            }
        }
        container.scrollLeft = element.offsetLeft - 10;
    }
    if (document.getElementById('last-opened-node') != null) {
        lastOpenedNode = document.getElementById('last-opened-node').innerHTML;
        element = document.getElementById(lastOpenedNode);
        if (element) {
            scrollIfNeeded(element, document.getElementById('tree'));
            element.classList.add("selected-item");
        }
    }
</script>

</html>